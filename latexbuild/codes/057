这张图非常好的展现了模拟退火的运行过程，从 T_0*T*0 开始，每次乘上 ΔΔ 得到 T*T* ，如果 T*T* 小于 T_k*T**k* 则终止降温。 T_0*T*0 我一般设置在 1000 ~ 5000 左右， ΔΔ 则是一个略小于1的常数，而 T_k*T**k* 一般设置在 1^{-8}1−8 到 1^{-15}1−15 之间(或者另外一个极小的数)。

在降温的同时，我们在 E_1*E*1 （不是最优解 E_0*E*0 ）的基础上扰动产生新解 E*E* ，需要注意的是扰动大小随温度的降低而变小，因为在温度高的时候，解的变化量非常大，这时的任务是在全局范围中找到最优解的大致位置，随着温度的降低，解渐渐稳定，这时的任务是确定最优解的准确位置。

但每次得出新解以后，我们以什么原则，或者说什么概率来接受它呢？

这时就要用到[Metropolis准则](https://baike.baidu.com/item/Metropolis接受准则/14678977?fr=aladdin)。简单说来，假设我们的目标是求最小值，如果 E*E* 与 E_0*E*0 的差，也就是 ΔEΔ*E* 小于 00 ，我们就接受当前解，因为它优于之前的最优解嘛。而如果 ΔEΔ*E* 大于 00 ，也就是我们遇到了一个更劣的解，我们也要以一定的概率来接受它，因为我们要找的一个多峰函数的全局最小值，因此就不能局限于一个局部的凹函数。而这个概率是 \exp (-ΔE/T)exp(−Δ*E*/*T*) 。

我个人对于这个概率的理解是这样的：对于 ΔEΔ*E* ，如果它较大，即我们遇到了一个劣得多的解，那我们接受它的概率就相对较小，因为 -ΔE−Δ*E* 较小嘛；而如果 ΔEΔ*E* 较小，即我们遇到了一个较劣的解，我们接受它的概率就较大，因为 -ΔE−Δ*E* 较大。对于 T*T* ，随着时间的增加， T*T* 变得越来越小，因此我们把 -ΔE−Δ*E* 除以 T*T* ，这样接受的概率就随着温度的降低而越来越小，因为 -ΔE−Δ*E* 是一个负数嘛。而对于整个式子，当 T*T* 较大的时候，我们会接受大部分的解，当 T*T* 较小的时候，我们就只会接受 ΔEΔ*E* 较小的解。~~关于Metropolis准则的具体证明，过于玄学，这里就不给出了。~~当然你也可以自己试一下。如果选择接受 E*E* ，则把 E_1*E*1 设置为 E*E* ，然后降温并寻找下一个解。